import{r as l,A as q,u as D,j as e,k as m,J as w,b as I,c as L,d as f,a as P,g as A,f as j,e as R,h as v,z as o,a5 as B,a6 as G,a7 as $,l as z}from"./index-BWa_XzmO.js";import{L as E}from"./Layout-DVG1ybMn.js";import{a as U}from"./api-Dehz_W2t.js";import"./logo-DmaGRGNz.js";const J=()=>{const{user:d}=l.useContext(q),y=D(),x=l.useRef(null),[p,h]=l.useState(!1),[u,c]=l.useState(!1),[b,k]=l.useState(null),[t,s]=l.useState({listingType:d?.activeRole==="donor"?"donation":"request",category:"Food",title:"",description:"",quantity:"",addressText:d?.addressText||"",pickupTime:"",condition:"New",foodType:"Veg",expiryDate:"",bookAuthor:"",image:null}),N=()=>{if(!navigator.geolocation)return o.error("GPS not supported by your browser");c(!0),navigator.geolocation.getCurrentPosition(async a=>{try{const{latitude:r,longitude:i}=a.coords,{data:n}=await z.get(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${r}&lon=${i}&email=hopelink.dev@example.com`),g=n.address.city||n.address.town||n.address.village||n.address.state||"Unknown Location";s(S=>({...S,addressText:g})),o.success(`Location locked: ${g} ðŸ“`)}catch{o.error("Could not resolve your city name.")}finally{c(!1)}},()=>{c(!1),o.error("Please allow location permissions in your browser.")},{enableHighAccuracy:!0})},T=a=>{const r=a.target.files[0];r&&(s({...t,image:r}),k(URL.createObjectURL(r)))},C=async a=>{if(a.preventDefault(),!t.title||!t.description||!t.addressText)return o.error("Please fill in all required fields.");h(!0);try{const r=new FormData;Object.keys(t).forEach(i=>{t[i]&&r.append(i,t[i])}),await U.post("/donations",r),o.success(t.listingType==="donation"?"Item posted for donation! ðŸš€":"Request broadcasted! ðŸ“¡"),y("/dashboard")}catch(r){o.error(r.response?.data?.message||"Failed to post item.")}finally{h(!1)}},F=[{id:"Food",icon:e.jsx(B,{}),color:"hover:border-orange-500 hover:text-orange-500",active:"bg-orange-500/20 border-orange-500 text-orange-400"},{id:"Clothes",icon:e.jsx(G,{}),color:"hover:border-pink-500 hover:text-pink-500",active:"bg-pink-500/20 border-pink-500 text-pink-400"},{id:"Book",icon:e.jsx(f,{}),color:"hover:border-blue-500 hover:text-blue-500",active:"bg-blue-500/20 border-blue-500 text-blue-400"},{id:"General",icon:e.jsx($,{}),color:"hover:border-teal-500 hover:text-teal-500",active:"bg-teal-500/20 border-teal-500 text-teal-400"}];return d?e.jsx(E,{children:e.jsxs("div",{className:"max-w-3xl mx-auto pb-24 relative",children:[e.jsxs("header",{className:"mb-8 text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-[#111] border border-white/10 rounded-full flex items-center justify-center text-4xl text-teal-400 mx-auto mb-4 shadow-xl",children:t.listingType==="donation"?e.jsx(m,{}):e.jsx(w,{})}),e.jsxs("h1",{className:"text-4xl font-black text-white italic tracking-tighter uppercase",children:["CREATE ",e.jsx("span",{className:t.listingType==="donation"?"text-teal-400":"text-blue-400",children:"LISTING."})]}),e.jsx("p",{className:"text-white/50 text-sm font-bold mt-2",children:"Share details with the community to make an impact."})]}),e.jsxs("form",{onSubmit:C,className:"space-y-8",children:[e.jsxs("div",{className:"bg-[#111] p-2 rounded-2xl border border-white/10 flex shadow-lg",children:[e.jsx("button",{type:"button",onClick:()=>s({...t,listingType:"donation"}),className:`flex-1 py-3 rounded-xl font-black text-xs uppercase tracking-widest transition-all ${t.listingType==="donation"?"bg-teal-500 text-white shadow-md":"text-white/40 hover:text-white"}`,children:"I am Donating"}),e.jsx("button",{type:"button",onClick:()=>s({...t,listingType:"request"}),className:`flex-1 py-3 rounded-xl font-black text-xs uppercase tracking-widest transition-all ${t.listingType==="request"?"bg-blue-600 text-white shadow-md":"text-white/40 hover:text-white"}`,children:"I am Requesting"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-black uppercase tracking-widest text-white/50 ml-2 mb-3 block",children:"1. Select Category"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:F.map(a=>e.jsxs("div",{onClick:()=>s({...t,category:a.id}),className:`cursor-pointer flex flex-col items-center justify-center p-6 rounded-3xl border-2 transition-all duration-300 ${t.category===a.id?a.active:`bg-[#111] border-white/5 text-white/40 ${a.color}`}`,children:[e.jsx("div",{className:"text-3xl mb-2",children:a.icon}),e.jsx("span",{className:"font-bold text-xs tracking-wider",children:a.id})]},a.id))})]}),e.jsxs("div",{className:"bg-[#111] p-6 rounded-[2rem] border border-white/10 shadow-xl space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-white/40 ml-4 mb-2 block",children:"Item Title *"}),e.jsx("input",{required:!0,type:"text",placeholder:"e.g. 10 Fresh Apples, Winter Jacket...",value:t.title,onChange:a=>s({...t,title:a.target.value}),className:"w-full bg-black/50 border border-white/10 rounded-2xl px-6 py-4 text-white font-bold placeholder-white/20 focus:border-teal-500 outline-none transition-all"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-white/40 ml-4 mb-2 block",children:"Quantity / Size"}),e.jsx("input",{type:"text",placeholder:"e.g. 5 kgs, Size M",value:t.quantity,onChange:a=>s({...t,quantity:a.target.value}),className:"w-full bg-black/50 border border-white/10 rounded-2xl px-6 py-4 text-white font-bold placeholder-white/20 focus:border-teal-500 outline-none transition-all"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-white/40 ml-4 mb-2 block",children:"Description *"}),e.jsx("textarea",{required:!0,rows:"3",placeholder:"Describe the item, location specifics, or reason for requesting...",value:t.description,onChange:a=>s({...t,description:a.target.value}),className:"w-full bg-black/50 border border-white/10 rounded-2xl px-6 py-4 text-white text-sm placeholder-white/20 focus:border-teal-500 outline-none transition-all resize-none"})]})]}),e.jsxs("div",{className:"bg-[#111] p-6 rounded-[2rem] border border-white/10 shadow-xl grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.category==="Food"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-[10px] font-black uppercase tracking-widest text-white/40 ml-4 mb-2 flex items-center gap-2",children:[e.jsx(I,{})," Food Type"]}),e.jsxs("select",{value:t.foodType,onChange:a=>s({...t,foodType:a.target.value}),className:"w-full bg-black/50 border border-white/10 rounded-2xl px-6 py-4 text-white font-bold outline-none focus:border-teal-500 cursor-pointer appearance-none",children:[e.jsx("option",{value:"Veg",children:"Vegetarian"}),e.jsx("option",{value:"Non-Veg",children:"Non-Vegetarian"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-[10px] font-black uppercase tracking-widest text-white/40 ml-4 mb-2 flex items-center gap-2",children:[e.jsx(L,{})," Expiry/Best Before"]}),e.jsx("input",{type:"date",value:t.expiryDate,onChange:a=>s({...t,expiryDate:a.target.value}),className:"w-full bg-black/50 border border-white/10 rounded-2xl px-6 py-4 text-white font-bold outline-none focus:border-teal-500"})]})]}),t.category==="Book"&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"text-[10px] font-black uppercase tracking-widest text-white/40 ml-4 mb-2 flex items-center gap-2",children:[e.jsx(f,{})," Author Name"]}),e.jsx("input",{type:"text",placeholder:"Author name",value:t.bookAuthor,onChange:a=>s({...t,bookAuthor:a.target.value}),className:"w-full bg-black/50 border border-white/10 rounded-2xl px-6 py-4 text-white font-bold outline-none focus:border-teal-500 placeholder-white/20"})]}),(t.category==="Clothes"||t.category==="Book"||t.category==="General")&&e.jsxs("div",{children:[e.jsxs("label",{className:"text-[10px] font-black uppercase tracking-widest text-white/40 ml-4 mb-2 flex items-center gap-2",children:[e.jsx(P,{})," Condition"]}),e.jsxs("select",{value:t.condition,onChange:a=>s({...t,condition:a.target.value}),className:"w-full bg-black/50 border border-white/10 rounded-2xl px-6 py-4 text-white font-bold outline-none focus:border-teal-500 cursor-pointer appearance-none",children:[e.jsx("option",{value:"New",children:"Brand New"}),e.jsx("option",{value:"Good",children:"Gently Used"}),e.jsx("option",{value:"Fair",children:"Fair"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-[10px] font-black uppercase tracking-widest text-white/40 ml-4 mb-2 flex items-center gap-2",children:[e.jsx(A,{})," Preferred Pickup Time"]}),e.jsx("input",{type:"text",placeholder:"e.g. 5 PM - 7 PM",value:t.pickupTime,onChange:a=>s({...t,pickupTime:a.target.value}),className:"w-full bg-black/50 border border-white/10 rounded-2xl px-6 py-4 text-white font-bold outline-none focus:border-teal-500 placeholder-white/20"})]})]}),e.jsxs("div",{className:"bg-[#111] p-6 rounded-[2rem] border border-white/10 shadow-xl grid grid-cols-1 md:grid-cols-2 gap-6 items-end",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-white/40 ml-4 mb-2 block",children:"Location *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{required:!0,type:"text",placeholder:"Type city or use GPS...",value:t.addressText,onChange:a=>s({...t,addressText:a.target.value}),className:"flex-1 bg-black/50 border border-white/10 rounded-2xl px-5 py-4 text-white font-bold placeholder-white/20 focus:border-teal-500 outline-none transition-all"}),e.jsx("button",{type:"button",onClick:N,disabled:u,className:"px-5 bg-teal-500/10 text-teal-400 border border-teal-500/30 rounded-2xl hover:bg-teal-500 hover:text-white transition-all disabled:opacity-50 flex items-center justify-center shadow-lg",title:"Detect My Location",children:u?e.jsx(j,{className:"animate-spin text-lg"}):e.jsx(R,{className:"text-lg"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-white/40 ml-4 mb-2 block",children:"Upload Image"}),e.jsx("input",{type:"file",accept:"image/*",ref:x,onChange:T,className:"hidden"}),e.jsx("div",{onClick:()=>x.current.click(),className:"w-full h-[58px] bg-black/50 border-2 border-dashed border-white/20 rounded-2xl flex items-center justify-center gap-3 cursor-pointer hover:bg-white/5 hover:border-teal-500 transition-all text-white/60 hover:text-white overflow-hidden relative group",children:b?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:b,alt:"Preview",className:"absolute inset-0 w-full h-full object-cover opacity-50 group-hover:opacity-30 transition-opacity"}),e.jsxs("span",{className:"relative z-10 font-bold text-xs uppercase tracking-widest text-white drop-shadow-md flex items-center gap-2",children:[e.jsx(v,{})," Change Image"]})]}):e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"text-lg"})," ",e.jsx("span",{className:"font-bold text-xs uppercase tracking-widest",children:"Select Image"})]})})]})]}),e.jsx("button",{type:"submit",disabled:p,className:`w-full py-5 rounded-2xl font-black text-white uppercase tracking-widest text-sm transition-all shadow-2xl flex items-center justify-center gap-3 active:scale-[0.98] ${t.listingType==="donation"?"bg-teal-500 hover:bg-teal-400 shadow-teal-500/30":"bg-blue-600 hover:bg-blue-500 shadow-blue-600/30"} disabled:opacity-50 disabled:active:scale-100 mt-4`,children:p?e.jsx(j,{className:"animate-spin text-2xl"}):e.jsxs(e.Fragment,{children:[t.listingType==="donation"?e.jsx(m,{className:"text-xl"}):e.jsx(w,{className:"text-xl"}),t.listingType==="donation"?"Publish Donation":"Broadcast Request"]})})]})]})}):null};export{J as default};
