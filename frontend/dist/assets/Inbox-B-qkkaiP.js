import{r as a,A as x,u as d,j as e,D as h,f as m,a9 as f,z as u}from"./index-BWa_XzmO.js";import{L as j}from"./Layout-DVG1ybMn.js";import{a as p}from"./api-Dehz_W2t.js";import"./logo-DmaGRGNz.js";const g=()=>{const{user:i}=a.useContext(x),r=d(),[n,o]=a.useState([]),[c,l]=a.useState(!0);return a.useEffect(()=>{if(!i){r("/dashboard");return}(async()=>{try{const{data:s}=await p.get("/chat/inbox");o(Array.isArray(s)?s:[]),l(!1)}catch{u.error("Failed to load messages"),l(!1)}})()},[i,r]),i?e.jsx(j,{children:e.jsxs("div",{className:"max-w-3xl mx-auto pb-24",children:[e.jsxs("header",{className:"mb-8 flex items-center gap-4",children:[e.jsx("button",{onClick:()=>r("/dashboard"),className:"text-white/50 hover:text-white transition-colors bg-[#111] p-4 rounded-2xl border border-white/10",children:e.jsx(h,{className:"text-xl"})}),e.jsx("div",{children:e.jsxs("h1",{className:"text-4xl md:text-5xl font-black text-white italic tracking-tighter",children:["MY ",e.jsx("span",{className:"text-teal-400",children:"INBOX."})]})})]}),e.jsx("div",{className:"bg-[#111] border border-white/10 rounded-[2rem] overflow-hidden shadow-2xl min-h-[50vh]",children:c?e.jsx("div",{className:"flex justify-center items-center h-[50vh]",children:e.jsx(m,{className:"animate-spin text-4xl text-teal-500"})}):n.length===0?e.jsxs("div",{className:"flex flex-col justify-center items-center h-[50vh] text-white/40",children:[e.jsx(f,{className:"text-5xl mb-4 opacity-20"}),e.jsx("p",{className:"font-bold uppercase tracking-widest text-sm",children:"No active conversations"})]}):e.jsx("div",{className:"divide-y divide-white/5",children:n.map((t,s)=>e.jsxs("div",{onClick:()=>r(`/chat/${t.donationId}`,{state:{otherUserId:t.otherUserId,otherUserName:t.otherUserName,itemTitle:t.donationTitle}}),className:"flex items-center gap-4 p-5 cursor-pointer hover:bg-white/5 transition-colors",children:[e.jsx("div",{className:"w-14 h-14 rounded-full bg-white/10 flex-shrink-0 flex items-center justify-center text-white font-black text-xl overflow-hidden uppercase",children:t.otherUserProfilePic?e.jsx("img",{src:t.otherUserProfilePic,alt:"User",className:"w-full h-full object-cover"}):t.otherUserName.charAt(0)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("h3",{className:"text-white font-bold text-lg truncate pr-2",children:t.otherUserName}),e.jsx("span",{className:"text-white/40 text-xs font-bold uppercase tracking-widest",children:new Date(t.updatedAt).toLocaleDateString([],{month:"short",day:"numeric"})})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"text-white/60 text-sm truncate pr-2",children:t.latestMessage}),t.unreadCount>0&&e.jsx("span",{className:"bg-teal-500 text-white text-[10px] font-black w-5 h-5 rounded-full flex items-center justify-center flex-shrink-0",children:t.unreadCount})]})]})]},s))})})]})}):null};export{g as default};
